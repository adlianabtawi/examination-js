<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Möbelbutik - Möbler och Inredning</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                    Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
                line-height: 1.6;
                color: #333;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
                padding: 0 20px;
            }

            /* Header */
            header {
                background: white;
                border-bottom: 1px solid #e5e5e5;
                position: sticky;
                top: 0;
                z-index: 100;
            }

            .header-content {
                display: flex;
                align-items: center;
                height: 64px;
                position: relative; /* allow absolute-centering the logo */
            }

            .logo {
                font-size: 20px;
                font-weight: 600;
                letter-spacing: -0.5px;
                cursor: pointer;
                background: none;
                border: none;
                color: #333;
                position: absolute; /* center the logo horizontally */
                left: 50%;
                transform: translateX(-50%);
            }

            .nav-menu {
                display: flex;
                align-items: center;
                gap: 32px;
                margin-right: auto; /* keep menu to the left */
            }

            .nav-menu button {
                background: none;
                border: none;
                cursor: pointer;
                padding: 8px 0;
                font-size: 15px;
                color: #333;
            }

            .nav-menu button.active {
                border-bottom: 2px solid black;
            }

            .cart-icon {
                position: relative;
                cursor: pointer;
            }

            /* Desktop-specific cart (moved out of the nav for precise layout)
               Use the id #cart-desktop on the desktop cart button. */
            #cart-desktop {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                margin-left: auto; /* push to the right */
            }

            .cart-badge {
                position: absolute;
                top: -8px;
                right: -8px;
                background: black;
                color: white;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 12px;
            }

            .menu-button {
                background: none;
                border: none;
                cursor: pointer;
                padding: 4px;
                display: none;
            }

            .menu-button.mobile {
                display: none;
            }

            .mobile-header-controls {
                display: none;
                align-items: center;
                gap: 16px;
            }

            /* Mobile cart is hidden on desktop by default */
            #cart-mobile {
                display: none;
            }

            /* Pages */
            .page {
                display: none;
                min-height: calc(100vh - 64px);
            }

            .page.active {
                display: block;
            }

            /* Home Page */
            .hero {
                background: #1a1a1a;
                color: white;
                padding: 64px 48px;
                margin: 32px 0;
            }

            .hero h1 {
                font-size: 48px;
                margin-bottom: 16px;
            }

            .hero p {
                color: #d1d1d1;
                font-size: 18px;
            }

            .product-grid {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 32px;
                margin-bottom: 64px;
            }

            .product-card {
                cursor: pointer;
                background: none;
                border: none;
                text-align: left;
                width: 100%;
                position: relative; /* allow action buttons to overlay */
            }

            .product-image {
                width: 100%;
                aspect-ratio: 1;
                background: #f5f5f5;
                margin-bottom: 12px;
                overflow: hidden;
                position: relative;
            }

            /* Overlay action containers placed on left and right bottom corners */
            .product-action-left,
            .product-action-right {
                position: absolute;
                bottom: 12px;
                display: flex;
                gap: 8px;
                align-items: center;
                pointer-events: auto; /* allow clicks */
                z-index: 5;
            }

            .product-action-left {
                left: 12px;
            }

            .product-action-right {
                right: 12px;
            }

            /* Action buttons (overlay add/remove) - use broad selector so classes apply
               even though buttons are not nested under a .product-actions wrapper */
            .action-btn {
                background: rgba(0, 0, 0, 0.85);
                color: white;
                border: none;
                padding: 8px 10px;
                font-size: 13px;
                cursor: pointer;
                border-radius: 6px;
                display: inline-flex;
                align-items: center;
                gap: 6px;
            }

            /* explicit add/remove colors */
            .action-btn.add-btn {
                background: #16a34a; /* green */
            }

            .action-btn.remove-btn {
                background: #dc2626; /* red */
                margin-right: 6px;
            }

            .action-btn .action-icon {
                width: 18px;
                height: 18px;
                display: inline-block;
                vertical-align: middle;
            }

            .action-btn .sign {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                width: 18px;
                height: 18px;
                border-radius: 50%;
                background: white;
                color: black;
                font-weight: 700;
                font-size: 12px;
                margin-left: 6px;
            }

            /* Larger sizes for desktop screens */
            @media (min-width: 769px) {
                /* Make overlay action buttons slightly bigger on desktop */
                .action-btn {
                    padding: 10px 14px;
                    font-size: 15px;
                }

                .action-btn .action-icon {
                    width: 20px;
                    height: 20px;
                }

                .action-btn .sign {
                    width: 20px;
                    height: 20px;
                    font-size: 13px;
                    margin-left: 8px;
                }

                /* Make quantity controls larger on desktop */
                .quantity-button {
                    width: 40px;
                    height: 40px;
                    border-radius: 6px;
                }

                .quantity-display {
                    width: 40px;
                }

                /* Make desktop cart icon a bit larger so it feels tappable */
                #cart-desktop .icon-img {
                    width: 28px;
                    height: 28px;
                }
            }

            .product-image img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                transition: transform 0.3s;
            }

            .product-card:hover .product-image img {
                transform: scale(1.05);
            }

            .product-name {
                font-size: 16px;
                margin-bottom: 4px;
                font-weight: 500;
            }

            .product-price {
                color: #666;
                font-size: 15px;
            }

            /* Product Page */
            .back-button {
                display: inline-flex;
                align-items: center;
                gap: 8px;
                background: none;
                border: none;
                cursor: pointer;
                margin: 32px 0 24px 0;
                font-size: 15px;
                color: #333;
            }

            .back-button:hover {
                text-decoration: underline;
            }

            .product-detail {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 48px;
                margin-bottom: 64px;
            }

            .product-detail-image {
                background: #f5f5f5;
                aspect-ratio: 1;
            }

            .product-detail-image img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .product-info {
                padding: 48px 0;
            }

            .product-info h1 {
                font-size: 36px;
                margin-bottom: 16px;
            }

            .product-info .price {
                font-size: 24px;
                color: #666;
                margin-bottom: 24px;
            }

            .product-description {
                color: #666;
                line-height: 1.8;
                margin-bottom: 32px;
            }

            .features {
                border-top: 1px solid #e5e5e5;
                padding-top: 24px;
                margin-bottom: 32px;
            }

            .features h3 {
                font-size: 18px;
                margin-bottom: 16px;
            }

            .features ul {
                list-style: none;
                color: #666;
            }

            .features li {
                margin-bottom: 8px;
            }

            .add-to-cart-button {
                background: black;
                color: white;
                border: none;
                padding: 14px 32px;
                font-size: 15px;
                cursor: pointer;
                transition: background 0.2s;
            }

            .add-to-cart-button:hover {
                background: #333;
            }

            /* Cart Page */
            .cart-container {
                padding: 32px 0 64px 0;
            }

            .cart-container h1 {
                font-size: 36px;
                margin-bottom: 32px;
            }

            .empty-cart {
                text-align: center;
                padding: 64px 0;
            }

            .empty-cart p {
                color: #666;
                margin-bottom: 32px;
            }

            .cart-layout {
                display: grid;
                grid-template-columns: 2fr 1fr;
                gap: 32px;
            }

            .cart-items {
                display: flex;
                flex-direction: column;
                gap: 16px;
            }

            .cart-item {
                display: flex;
                gap: 16px;
                border: 1px solid #e5e5e5;
                padding: 16px;
            }

            .cart-item-image {
                width: 120px;
                height: 120px;
                background: #f5f5f5;
                flex-shrink: 0;
            }

            .cart-item-image img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            .cart-item-info {
                flex: 1;
            }

            .cart-item-name {
                font-size: 16px;
                font-weight: 500;
                margin-bottom: 8px;
            }

            .cart-item-price {
                color: #666;
                margin-bottom: 16px;
            }

            .quantity-controls {
                display: flex;
                align-items: center;
                gap: 12px;
            }

            .quantity-button {
                width: 32px;
                height: 32px;
                border: 1px solid #d1d1d1;
                background: white;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .quantity-button:hover {
                background: #f5f5f5;
            }

            .quantity-display {
                width: 32px;
                text-align: center;
            }

            .cart-item-actions {
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: flex-end;
            }

            .remove-button {
                background: none;
                border: none;
                color: #999;
                cursor: pointer;
                padding: 4px;
            }

            .remove-button:hover {
                color: #dc2626;
            }

            .cart-item-total {
                font-weight: 500;
            }

            .order-summary {
                border: 1px solid #e5e5e5;
                padding: 24px;
                height: fit-content;
                position: sticky;
                top: 80px;
            }

            .order-summary h2 {
                font-size: 24px;
                margin-bottom: 24px;
            }

            .summary-line {
                display: flex;
                justify-content: space-between;
                margin-bottom: 12px;
            }

            .summary-line.total {
                border-top: 1px solid #e5e5e5;
                padding-top: 12px;
                font-weight: 600;
            }

            .checkout-button {
                width: 100%;
                background: black;
                color: white;
                border: none;
                padding: 14px;
                font-size: 15px;
                cursor: pointer;
                margin-top: 24px;
                margin-bottom: 12px;
            }

            .checkout-button:hover {
                background: #333;
            }

            .continue-shopping-button {
                width: 100%;
                background: white;
                border: 1px solid #d1d1d1;
                padding: 14px;
                font-size: 15px;
                cursor: pointer;
            }

            .continue-shopping-button:hover {
                background: #f5f5f5;
            }

            /* Responsive */
            @media (max-width: 768px) {
                .nav-menu {
                    display: none;
                    flex-direction: column;
                    gap: 0;
                    position: absolute;
                    top: 64px;
                    left: 0;
                    right: 0;
                    background: white;
                    border-top: 1px solid #e5e5e5;
                    padding: 16px;
                    width: 100%;
                }

                .nav-menu.open {
                    display: flex;
                }

                .nav-menu button {
                    padding: 12px 16px;
                    text-align: left;
                    border: none;
                }

                .nav-menu button.active {
                    border-bottom: none;
                }

                .nav-menu button:hover {
                    background: #f5f5f5;
                }

                /* hide the desktop cart on small screens; mobile uses #cart-mobile */
                #cart-desktop {
                    display: none;
                }

                /* show mobile cart and menu-toggle on small screens and spread them to edges */
                #cart-mobile {
                    display: inline-flex;
                }

                /* ensure the menu button is shown on mobile (already set) and we space header items */
                .menu-button.mobile {
                    display: block;
                }

                .header-content {
                    justify-content: space-between;
                }

                .mobile-header-controls {
                    display: flex;
                }

                .menu-button.mobile {
                    display: block;
                }

                .hero {
                    padding: 48px 24px;
                }

                .hero h1 {
                    font-size: 32px;
                }

                .product-grid {
                    grid-template-columns: repeat(2, 1fr);
                    gap: 16px;
                }

                .product-detail {
                    grid-template-columns: 1fr;
                    gap: 24px;
                }

                .product-info {
                    padding: 0;
                }

                .cart-layout {
                    grid-template-columns: 1fr;
                }

                .cart-item-image {
                    width: 80px;
                    height: 80px;
                }
            }

            /* Icons */
            .icon {
                width: 20px;
                height: 20px;
                stroke: currentColor;
                stroke-width: 2;
                fill: none;
            }
            /* img-based icons (beginner-friendly) */
            .icon-img {
                width: 20px;
                height: 20px;
                display: inline-block;
                vertical-align: middle;
            }

            /* Modal (product detail popup) */
            .modal.hidden {
                display: none;
            }

            .modal {
                position: fixed;
                inset: 0;
                display: flex;
                align-items: center;
                justify-content: center;
                background: rgba(0, 0, 0, 0.5);
                padding: 20px;
                z-index: 300;
            }

            .modal-content {
                background: white;
                width: 100%;
                max-width: 900px;
                max-height: 80vh;
                overflow: auto;
                border-radius: 8px;
                padding: 20px;
                position: relative;
            }

            .modal-close {
                position: absolute;
                top: 12px;
                right: 12px;
                background: rgba(0, 0, 0, 0.8);
                color: #fff;
                font-size: 18px;
                line-height: 1;
                padding: 8px 10px;
                border-radius: 999px;
                cursor: pointer;
                box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
                transition: background 120ms ease, transform 120ms ease;
                border: none;
                z-index: 12;
            }

            .modal-close:hover {
                background: rgba(0, 0, 0, 0.9);
                transform: translateY(-2px);
            }

            .modal-close:focus {
                outline: 3px solid rgba(255, 255, 255, 0.12);
                outline-offset: 2px;
                box-shadow: 0 0 0 4px rgba(21, 156, 228, 0.12);
            }

            /* Modal-specific adjustments so product images stay smaller on desktop
               and avoid forcing the modal to scroll vertically. */
            @media (min-width: 769px) {
                .modal-content .product-detail {
                    display: grid;
                    grid-template-columns: 380px 1fr; /* image column + info */
                    gap: 24px;
                    align-items: start;
                }

                .modal-content .product-detail-image {
                    max-width: 380px;
                    width: 100%;
                    aspect-ratio: auto;
                    background: #f5f5f5;
                }

                .modal-content .product-detail-image img {
                    width: 100%;
                    height: auto;
                    object-fit: contain;
                    max-height: calc(80vh - 160px);
                }

                .modal-content .product-info {
                    padding: 16px 8px;
                }
            }
        </style>
    </head>
    <body>
        <!-- Header -->
        <header>
            <div class="container">
                <div class="header-content">
                    <button class="menu-button mobile" id="menu-toggle">
                        <img
                            id="menu-icon"
                            class="icon-img"
                            src="icons/menu.svg"
                            alt="Menu"
                        />
                    </button>

                    <nav class="nav-menu">
                        <button id="nav-products" class="active">
                            Produkter
                        </button>
                        <button id="nav-about">Om Oss</button>
                        <button id="nav-contact">Kontakt</button>
                        <button id="nav-faq">FAQ</button>
                    </nav>

                    <button class="logo">MÖBLER</button>

                    <!-- Desktop cart, positioned to the right via CSS -->
                    <button class="cart-icon" id="cart-desktop">
                        <img src="icons/cart.svg" alt="Cart" class="icon-img" />
                        <span class="cart-badge" id="cart-badge">0</span>
                    </button>

                    <!-- Mobile cart placed after desktop cart; hidden on desktop, shown on mobile -->
                    <button class="cart-icon" id="cart-mobile">
                        <img src="icons/cart.svg" alt="Cart" class="icon-img" />
                        <span class="cart-badge" id="cart-badge-mobile">0</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Product modal popup (hidden by default) -->
        <div id="product-modal" class="modal hidden" aria-hidden="true">
            <div class="modal-content" id="product-modal-content">
                <button
                    id="product-modal-close"
                    class="modal-close"
                    aria-label="Stäng"
                    title="Stäng"
                >
                    ×
                </button>
                <!-- Product detail DOM will be injected here -->
            </div>
        </div>

        <!-- Cart modal popup (hidden by default) -->
        <div id="cart-modal" class="modal hidden" aria-hidden="true">
            <div class="modal-content" id="cart-modal-content">
                <button
                    id="cart-modal-close"
                    class="modal-close"
                    aria-label="Stäng"
                    title="Stäng"
                >
                    ×
                </button>
                <!-- Cart detail DOM will be injected here -->
            </div>
        </div>

        <!-- Home Page -->
        <div id="home-page" class="page active">
            <div class="container">
                <div class="hero">
                    <h1>Ny Kollektion</h1>
                    <p>Upptäck vår senaste möbler och hemdekorationsdelar</p>
                </div>
                <div class="product-grid" id="product-grid"></div>
            </div>
        </div>

        <!-- Product Page -->
        <div id="product-page" class="page">
            <div class="container">
                <button class="back-button">
                    <img src="icons/back.svg" class="icon-img" alt="Tillbaka" />
                    Tillbaka till produkter
                </button>
                <div id="product-detail"></div>
            </div>
        </div>

        <!-- Cart Page -->
        <div id="cart-page" class="page">
            <div class="container cart-container">
                <h1>Varukorg</h1>
                <div id="cart-content"></div>
            </div>
        </div>

        <script>
            // Array of product objects (read-only after init)
            const products = [
                {
                    id: 1,
                    name: "Modern Stol",
                    price: 3135,
                    image: "https://images.unsplash.com/photo-1760716478137-d861d5b354e8?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800",
                    description:
                        "En elegant modern stol med premiumtyg. Perfekt för varje samtida boendemiljö. Ergonomisk design för maximal komfort.",
                    features: [
                        "Premiumkvalitetsmaterial",
                        "Noggrant hantverk",
                        "Hållbar konstruktion",
                        "Lätt att underhålla",
                    ],
                },
                {
                    id: 2,
                    name: "Designer Lampa",
                    price: 1564,
                    image: "https://images.unsplash.com/photo-1702505973200-cce1a216f92b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800",
                    description:
                        "En samtida designerlampa med justerbar ljusstyrka. Tillför en touch av sofistikation till ditt arbetsrum eller sovrum. Energieffektiv LED-teknik.",
                    features: [
                        "Premiumkvalitetsmaterial",
                        "Noggrant hantverk",
                        "Hållbar konstruktion",
                        "Lätt att underhålla",
                    ],
                },
                {
                    id: 3,
                    name: "Keramisk Vas",
                    price: 830,
                    image: "https://images.unsplash.com/photo-1612196808214-b8e1d6145a8c?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800",
                    description:
                        "En handgjord keramisk vas med minimalistisk design. Perfekt för att visa fram färska blommor eller som en fristående dekorativ prydnad. Gjord av lokala hantverkare.",
                    features: [
                        "Premiumkvalitetsmaterial",
                        "Noggrant hantverk",
                        "Hållbar konstruktion",
                        "Lätt att underhålla",
                    ],
                },
                {
                    id: 4,
                    name: "Soffbord",
                    price: 5235,
                    image: "https://images.unsplash.com/photo-1617638924751-cc232f82ecf9?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800",
                    description:
                        "Ett solidt soffbord av trä med modernt utförande. Robust konstruktion med rena linjer. Perfekt mittpiece för ditt vardagsrum.",
                    features: [
                        "Premiumkvalitetsmaterial",
                        "Noggrant hantverk",
                        "Hållbar konstruktion",
                        "Lätt att underhålla",
                    ],
                },
                {
                    id: 5,
                    name: "Väggklocka",
                    price: 935,
                    image: "https://images.unsplash.com/photo-1566663409293-585e129d2e71?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800",
                    description:
                        "En minimalistisk väggklocka med tyst mekanik. Har en ren design som passar till vilken inredning som helst. Batteridrivad för enkel installation.",
                    features: [
                        "Premiumkvalitetsmaterial",
                        "Noggrant hantverk",
                        "Hållbar konstruktion",
                        "Lätt att underhålla",
                    ],
                },
                {
                    id: 6,
                    name: "Dekorativ Uppsättning",
                    price: 2090,
                    image: "https://images.unsplash.com/photo-1711564354293-30760984899e?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&w=800",
                    description:
                        "En kurerad dekorativ uppsättning med flera delar. Varje föremål noggrant utvalt för att skapa en sammanhängande estetik. Perfekt för att utsmycka hyllor och ytor.",
                    features: [
                        "Premiumkvalitetsmaterial",
                        "Noggrant hantverk",
                        "Hållbar konstruktion",
                        "Lätt att underhålla",
                    ],
                },
            ];

            (function () {
                const app = {
                    // Simple application state
                    cart: [],
                    currentPage: "home",
                    selectedProduct: null,
                    menuOpen: false,

                    // Initialize the app
                    init: function () {
                        this.renderProducts();
                        this.updateCartBadge();

                        // Attach event listeners instead of inline onclick attributes
                        const logo = document.querySelector(".logo");
                        if (logo) {
                            logo.addEventListener("click", function () {
                                app.navigateTo("home");
                            });
                        }

                        // Wire up nav items dynamically
                        const navItems = [
                            {
                                id: "nav-products",
                                action: function () {
                                    app.navigateTo("home");
                                },
                            },
                        ];

                        for (let n = 0; n < navItems.length; n++) {
                            const item = navItems[n];
                            const element = document.getElementById(item.id);
                            if (element) {
                                element.addEventListener("click", item.action);
                            }
                        }

                        // Desktop cart button (moved out of the nav)
                        const cartIcon =
                            document.getElementById("cart-desktop");
                        if (cartIcon) {
                            cartIcon.addEventListener("click", function () {
                                app.showCartModal();
                            });
                        }

                        const cartMobile =
                            document.getElementById("cart-mobile");
                        if (cartMobile) {
                            cartMobile.addEventListener("click", function () {
                                app.showCartModal();
                                app.closeMenuIfOpen();
                            });
                        }

                        const menuToggle =
                            document.getElementById("menu-toggle");
                        if (menuToggle) {
                            menuToggle.addEventListener("click", function () {
                                app.toggleMenu();
                            });
                        }

                        const backBtn = document.querySelector(".back-button");
                        if (backBtn) {
                            backBtn.addEventListener("click", function () {
                                app.navigateTo("home");
                            });
                        }

                        // Wire modal close button
                        const modalClose = document.getElementById(
                            "product-modal-close"
                        );
                        if (modalClose) {
                            modalClose.addEventListener("click", function () {
                                app.closeProductModal();
                            });
                        }
                        // Wire cart modal close button (visible '×' on cart popup)
                        const cartModalClose =
                            document.getElementById("cart-modal-close");
                        if (cartModalClose) {
                            cartModalClose.addEventListener(
                                "click",
                                function () {
                                    app.closeCartModal();
                                }
                            );
                        }
                    },

                    /*
                     * navigateTo(page)
                     * Advanced construct avoided: using forEach with arrow functions and template literals.
                     * Beginner-friendly: use a plain for-loop and simple string concatenation.
                     */
                    navigateTo: function (page) {
                        const pages = document.querySelectorAll(".page");
                        for (let i = 0; i < pages.length; i++) {
                            pages[i].classList.remove("active");
                        }
                        // Avoid template literals for beginners; use + for concatenation
                        document
                            .getElementById(page + "-page")
                            .classList.add("active");
                        this.currentPage = page;

                        if (page === "cart") {
                            this.renderCart();
                        }

                        window.scrollTo(0, 0);
                    },

                    /*
                     * toggleMenu()
                     * Toggle the mobile menu open/closed state
                     */
                    toggleMenu: function () {
                        this.menuOpen = !this.menuOpen;
                        const menu = document.querySelector(".nav-menu");
                        const icon = document.getElementById("menu-icon");

                        if (this.menuOpen) {
                            menu.classList.add("open");
                            // show the close (X) icon
                            icon.src = "icons/close.svg";
                        } else {
                            menu.classList.remove("open");
                            // show the hamburger (menu) icon
                            icon.src = "icons/menu.svg";
                        }
                    },

                    /*
                     * closeMenuIfOpen()
                     * Helper function to close menu after navigation on mobile
                     */
                    closeMenuIfOpen: function () {
                        if (this.menuOpen) {
                            this.toggleMenu();
                        }
                    },

                    /*
                     * renderProducts()
                     * Advanced construct replaced: map + template literals + innerHTML
                     * Beginner-friendly: create DOM elements in a for-loop using createElement/appendChild.
                     */
                    renderProducts: function () {
                        const grid = document.getElementById("product-grid");
                        grid.innerHTML = "";

                        for (let i = 0; i < products.length; i++) {
                            const product = products[i];

                            // Use a div for the card so we can place buttons inside it
                            const card = document.createElement("div");
                            card.className = "product-card";
                            card.setAttribute("role", "button");
                            card.tabIndex = 0;
                            // clicking the card opens product detail
                            (function (id) {
                                card.addEventListener("click", function (e) {
                                    // don't trigger when clicking the action buttons
                                    if (e.target.closest(".product-actions"))
                                        return;
                                    app.viewProduct(id);
                                });
                                card.addEventListener("keydown", function (ev) {
                                    if (ev.key === "Enter") app.viewProduct(id);
                                });
                            })(product.id);

                            const imgWrap = document.createElement("div");
                            imgWrap.className = "product-image";
                            const img = document.createElement("img");
                            img.src = product.image;
                            img.alt = product.name;
                            imgWrap.appendChild(img);

                            const nameDiv = document.createElement("div");
                            nameDiv.className = "product-name";
                            nameDiv.textContent = product.name;

                            const priceDiv = document.createElement("div");
                            priceDiv.className = "product-price";
                            priceDiv.textContent = product.price + " kr";

                            // Action buttons overlay: separate left and right containers
                            const leftContainer = document.createElement("div");
                            leftContainer.className = "product-action-left";
                            const rightContainer =
                                document.createElement("div");
                            rightContainer.className = "product-action-right";

                            const removeBtn = document.createElement("button");
                            removeBtn.className = "action-btn remove-btn";
                            removeBtn.innerHTML =
                                '<svg class="action-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="9" cy="20" r="1"></circle><circle cx="19" cy="20" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg><span class="sign">−</span>';
                            (function (id) {
                                removeBtn.addEventListener(
                                    "click",
                                    function (e) {
                                        e.stopPropagation();
                                        app.removeFromCart(id);
                                    }
                                );
                            })(product.id);

                            const addBtn = document.createElement("button");
                            addBtn.className = "action-btn add-btn";
                            addBtn.innerHTML =
                                '<svg class="action-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="9" cy="20" r="1"></circle><circle cx="19" cy="20" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg><span class="sign">+</span>';
                            (function (id) {
                                addBtn.addEventListener("click", function (e) {
                                    e.stopPropagation();
                                    app.addToCart(id);
                                });
                            })(product.id);

                            // Determine if product is in cart
                            let inCart = false;
                            for (let c = 0; c < this.cart.length; c++) {
                                if (this.cart[c].id === product.id) {
                                    inCart = true;
                                    break;
                                }
                            }

                            if (inCart) {
                                // remove left, add right
                                leftContainer.appendChild(removeBtn);
                                rightContainer.appendChild(addBtn);
                            } else {
                                rightContainer.appendChild(addBtn);
                            }

                            // place containers inside the image wrapper so they hover over the picture
                            imgWrap.appendChild(leftContainer);
                            imgWrap.appendChild(rightContainer);

                            card.appendChild(imgWrap);
                            card.appendChild(nameDiv);
                            card.appendChild(priceDiv);

                            grid.appendChild(card);
                        }
                    },

                    /*
                     * viewProduct(productId)
                     * Advanced construct replaced: find() with arrow function
                     * Beginner-friendly: plain for-loop search
                     */
                    viewProduct: function (productId) {
                        // Find the product and open it in a modal popup instead of navigating
                        for (let i = 0; i < products.length; i++) {
                            if (products[i].id === productId) {
                                this.selectedProduct = products[i];
                                break;
                            }
                        }
                        this.showProductModal();
                    },

                    /*
                     * renderProductDetail()
                     * Advanced construct replaced: building a large template literal and setting innerHTML
                     * Beginner-friendly: construct DOM nodes with createElement and appendChild
                     */
                    renderProductDetail: function () {
                        const product = this.selectedProduct;
                        const container =
                            document.getElementById("product-detail");
                        container.innerHTML = "";

                        const detail = document.createElement("div");
                        detail.className = "product-detail";

                        const imgWrap = document.createElement("div");
                        imgWrap.className = "product-detail-image";
                        const img = document.createElement("img");
                        img.src = product.image;
                        img.alt = product.name;
                        imgWrap.appendChild(img);

                        const info = document.createElement("div");
                        info.className = "product-info";

                        const h1 = document.createElement("h1");
                        h1.textContent = product.name;

                        const price = document.createElement("div");
                        price.className = "price";
                        price.textContent = product.price + " kr";

                        const desc = document.createElement("div");
                        desc.className = "product-description";
                        const p = document.createElement("p");
                        p.textContent = product.description;
                        desc.appendChild(p);

                        const features = document.createElement("div");
                        features.className = "features";
                        const h3 = document.createElement("h3");
                        h3.textContent = "Features";
                        const ul = document.createElement("ul");
                        for (let j = 0; j < product.features.length; j++) {
                            const li = document.createElement("li");
                            li.textContent = "• " + product.features[j];
                            ul.appendChild(li);
                        }
                        features.appendChild(h3);
                        features.appendChild(ul);

                        const addButton = document.createElement("button");
                        addButton.className = "add-to-cart-button";
                        addButton.textContent = "Lägg till varukorg";
                        (function (id) {
                            addButton.addEventListener("click", function () {
                                app.addToCart(id);
                            });
                        })(product.id);

                        info.appendChild(h1);
                        info.appendChild(price);
                        info.appendChild(desc);
                        info.appendChild(features);
                        info.appendChild(addButton);

                        detail.appendChild(imgWrap);
                        detail.appendChild(info);

                        container.appendChild(detail);
                    },

                    /* showProductModal()
                     * Build the product detail inside the modal and show it.
                     */
                    showProductModal: function () {
                        const product = this.selectedProduct;
                        const modal = document.getElementById("product-modal");
                        const modalContent = document.getElementById(
                            "product-modal-content"
                        );

                        // Clear modal content and create a fresh close button so it
                        // is always present in the DOM (avoids issues when innerHTML is used).
                        // Remove any old close button with the same id to avoid duplicates.
                        const oldClose = document.getElementById(
                            "product-modal-close"
                        );
                        if (oldClose && oldClose.parentNode) {
                            oldClose.parentNode.removeChild(oldClose);
                        }
                        modalContent.innerHTML = "";

                        // Create a new close button and wire it immediately.
                        const closeBtn = document.createElement("button");
                        closeBtn.id = "product-modal-close";
                        closeBtn.className = "modal-close";
                        closeBtn.setAttribute("aria-label", "Stäng");
                        closeBtn.title = "Stäng";
                        closeBtn.textContent = "×";
                        closeBtn.addEventListener("click", function () {
                            app.closeProductModal();
                        });
                        modalContent.appendChild(closeBtn);

                        const detail = document.createElement("div");
                        detail.className = "product-detail";

                        const imgWrap = document.createElement("div");
                        imgWrap.className = "product-detail-image";
                        const img = document.createElement("img");
                        img.src = product.image;
                        img.alt = product.name;
                        imgWrap.appendChild(img);

                        const info = document.createElement("div");
                        info.className = "product-info";

                        const h1 = document.createElement("h1");
                        h1.textContent = product.name;

                        const price = document.createElement("div");
                        price.className = "price";
                        price.textContent = product.price + " kr";

                        const desc = document.createElement("div");
                        desc.className = "product-description";
                        const p = document.createElement("p");
                        p.textContent = product.description;
                        desc.appendChild(p);

                        const features = document.createElement("div");
                        features.className = "features";
                        const h3 = document.createElement("h3");
                        h3.textContent = "Features";
                        const ul = document.createElement("ul");
                        for (let j = 0; j < product.features.length; j++) {
                            const li = document.createElement("li");
                            li.textContent = "• " + product.features[j];
                            ul.appendChild(li);
                        }
                        features.appendChild(h3);
                        features.appendChild(ul);

                        const addButton = document.createElement("button");
                        addButton.className = "add-to-cart-button";
                        addButton.textContent = "Lägg till varukorg";
                        (function (id) {
                            addButton.addEventListener("click", function () {
                                app.addToCart(id);
                                app.closeProductModal();
                            });
                        })(product.id);

                        info.appendChild(h1);
                        info.appendChild(price);
                        info.appendChild(desc);
                        info.appendChild(features);
                        info.appendChild(addButton);

                        detail.appendChild(imgWrap);
                        detail.appendChild(info);

                        modalContent.appendChild(detail);

                        // Show modal
                        modal.classList.remove("hidden");
                        modal.setAttribute("aria-hidden", "false");

                        // Close when clicking overlay (but not when clicking inside modal-content)
                        (function () {
                            const onOverlayClick = function (e) {
                                if (e.target === modal) {
                                    app.closeProductModal();
                                }
                            };
                            // detach any previous to avoid duplicates
                            modal.removeEventListener("click", onOverlayClick);
                            modal.addEventListener("click", onOverlayClick);
                        })();
                    },

                    closeProductModal: function () {
                        const modal = document.getElementById("product-modal");
                        if (!modal) return;
                        modal.classList.add("hidden");
                        modal.setAttribute("aria-hidden", "true");
                        const modalContent = document.getElementById(
                            "product-modal-content"
                        );
                        if (modalContent) {
                            // keep the close button in the modal content
                            const closeBtn = document.getElementById(
                                "product-modal-close"
                            );
                            modalContent.innerHTML = "";
                            if (closeBtn) modalContent.appendChild(closeBtn);
                        }
                    },

                    /* showCartModal()
                     * Build the cart DOM inside the cart modal and show it.
                     */
                    showCartModal: function () {
                        const modal = document.getElementById("cart-modal");
                        const modalContent =
                            document.getElementById("cart-modal-content");
                        if (!modal || !modalContent) return;

                        // Create a fresh close button and a dedicated body container
                        // for the cart content so _renderCartInto() doesn't clear the
                        // entire modal content and accidentally remove the close button.
                        const oldCloseC =
                            document.getElementById("cart-modal-close");
                        if (oldCloseC && oldCloseC.parentNode) {
                            oldCloseC.parentNode.removeChild(oldCloseC);
                        }
                        modalContent.innerHTML = "";

                        const closeBtn = document.createElement("button");
                        closeBtn.id = "cart-modal-close";
                        closeBtn.className = "modal-close";
                        closeBtn.setAttribute("aria-label", "Stäng");
                        closeBtn.title = "Stäng";
                        closeBtn.textContent = "×";
                        closeBtn.addEventListener("click", function () {
                            app.closeCartModal();
                        });

                        // Body container where the cart DOM will be injected
                        const body = document.createElement("div");
                        body.id = "cart-modal-body";

                        modalContent.appendChild(closeBtn);
                        modalContent.appendChild(body);

                        // Render cart into the dedicated body element
                        this._renderCartInto(body);

                        modal.classList.remove("hidden");
                        modal.setAttribute("aria-hidden", "false");

                        // Overlay click to close
                        (function () {
                            const onOverlayClick = function (e) {
                                if (e.target === modal) {
                                    app.closeCartModal();
                                }
                            };
                            modal.removeEventListener("click", onOverlayClick);
                            modal.addEventListener("click", onOverlayClick);
                        })();
                    },

                    closeCartModal: function () {
                        const modal = document.getElementById("cart-modal");
                        if (!modal) return;
                        modal.classList.add("hidden");
                        modal.setAttribute("aria-hidden", "true");
                        const modalContent =
                            document.getElementById("cart-modal-content");
                        if (modalContent) {
                            const closeBtn =
                                document.getElementById("cart-modal-close");
                            modalContent.innerHTML = "";
                            if (closeBtn) modalContent.appendChild(closeBtn);
                        }
                    },

                    /* _renderCartInto(container)
                     * Internal helper: builds cart DOM into the given container element.
                     * This duplicates renderCart's logic but targets an arbitrary container
                     * so the cart can be shown either as a page or inside a modal.
                     */
                    _renderCartInto: function (container) {
                        if (!container) return;

                        if (this.cart.length === 0) {
                            container.innerHTML = "";
                            const empty = document.createElement("div");
                            empty.className = "empty-cart";
                            const p = document.createElement("p");
                            p.textContent = "Din varukorg är tom";
                            const cont = document.createElement("button");
                            cont.className = "add-to-cart-button";
                            cont.textContent = "Fortsätt handla";
                            cont.addEventListener("click", function () {
                                // Close modal (harmless if not open) and navigate home
                                app.closeCartModal();
                                app.navigateTo("home");
                            });
                            empty.appendChild(p);
                            empty.appendChild(cont);
                            container.appendChild(empty);
                            return;
                        }

                        let subtotal = 0;
                        for (let i = 0; i < this.cart.length; i++) {
                            subtotal +=
                                this.cart[i].price * this.cart[i].quantity;
                        }
                        const shipping = 150;
                        const total = subtotal + shipping;

                        container.innerHTML = "";

                        const layout = document.createElement("div");
                        layout.className = "cart-layout";

                        const itemsDiv = document.createElement("div");
                        itemsDiv.className = "cart-items";

                        for (let j = 0; j < this.cart.length; j++) {
                            const item = this.cart[j];

                            const cartItem = document.createElement("div");
                            cartItem.className = "cart-item";

                            const imageWrap = document.createElement("div");
                            imageWrap.className = "cart-item-image";
                            const iImg = document.createElement("img");
                            iImg.src = item.image;
                            iImg.alt = item.name;
                            imageWrap.appendChild(iImg);

                            const info = document.createElement("div");
                            info.className = "cart-item-info";
                            const nameDiv = document.createElement("div");
                            nameDiv.className = "cart-item-name";
                            nameDiv.textContent = item.name;
                            const priceDiv = document.createElement("div");
                            priceDiv.className = "cart-item-price";
                            priceDiv.textContent = item.price + " kr";

                            const qtyControls = document.createElement("div");
                            qtyControls.className = "quantity-controls";

                            const minusBtn = document.createElement("button");
                            minusBtn.className = "quantity-button";
                            minusBtn.innerHTML =
                                '<img src="icons/minus.svg" style="width:16px;height:16px;" alt="minus">';
                            (function (id, current) {
                                minusBtn.addEventListener("click", function () {
                                    app.updateQuantity(id, current - 1);
                                    // also refresh modal if open
                                    const m =
                                        document.getElementById("cart-modal");
                                    if (m && !m.classList.contains("hidden")) {
                                        app.showCartModal();
                                    }
                                });
                            })(item.id, item.quantity);

                            const qtyDisplay = document.createElement("div");
                            qtyDisplay.className = "quantity-display";
                            qtyDisplay.textContent = item.quantity;

                            const plusBtn = document.createElement("button");
                            plusBtn.className = "quantity-button";
                            plusBtn.innerHTML =
                                '<img src="icons/plus.svg" style="width:16px;height:16px;" alt="plus">';
                            (function (id, current) {
                                plusBtn.addEventListener("click", function () {
                                    app.updateQuantity(id, current + 1);
                                    const m =
                                        document.getElementById("cart-modal");
                                    if (m && !m.classList.contains("hidden")) {
                                        app.showCartModal();
                                    }
                                });
                            })(item.id, item.quantity);

                            qtyControls.appendChild(minusBtn);
                            qtyControls.appendChild(qtyDisplay);
                            qtyControls.appendChild(plusBtn);

                            info.appendChild(nameDiv);
                            info.appendChild(priceDiv);
                            info.appendChild(qtyControls);

                            const actions = document.createElement("div");
                            actions.className = "cart-item-actions";

                            const removeBtn = document.createElement("button");
                            removeBtn.className = "remove-button";
                            removeBtn.innerHTML =
                                '<img src="icons/trash.svg" style="width:16px;height:16px;" alt="remove">';
                            (function (id) {
                                removeBtn.addEventListener(
                                    "click",
                                    function () {
                                        app.removeFromCart(id);
                                        const m =
                                            document.getElementById(
                                                "cart-modal"
                                            );
                                        if (
                                            m &&
                                            !m.classList.contains("hidden")
                                        ) {
                                            app.showCartModal();
                                        }
                                    }
                                );
                            })(item.id);

                            const itemTotal = document.createElement("div");
                            itemTotal.className = "cart-item-total";
                            itemTotal.textContent =
                                item.price * item.quantity + " kr";

                            actions.appendChild(removeBtn);
                            actions.appendChild(itemTotal);

                            cartItem.appendChild(imageWrap);
                            cartItem.appendChild(info);
                            cartItem.appendChild(actions);

                            itemsDiv.appendChild(cartItem);
                        }

                        const summary = document.createElement("div");
                        summary.className = "order-summary";
                        const h2 = document.createElement("h2");
                        h2.textContent = "Ordersammanfattning";
                        summary.appendChild(h2);

                        const line1 = document.createElement("div");
                        line1.className = "summary-line";
                        const s1a = document.createElement("span");
                        s1a.textContent = "Delsumma";
                        const s1b = document.createElement("span");
                        s1b.textContent = subtotal + " kr";
                        line1.appendChild(s1a);
                        line1.appendChild(s1b);

                        const line2 = document.createElement("div");
                        line2.className = "summary-line";
                        const s2a = document.createElement("span");
                        s2a.textContent = "Frakt";
                        const s2b = document.createElement("span");
                        s2b.textContent = shipping + " kr";
                        line2.appendChild(s2a);
                        line2.appendChild(s2b);

                        const line3 = document.createElement("div");
                        line3.className = "summary-line total";
                        const s3a = document.createElement("span");
                        s3a.textContent = "Total";
                        const s3b = document.createElement("span");
                        s3b.textContent = total + " kr";
                        line3.appendChild(s3a);
                        line3.appendChild(s3b);

                        const checkoutBtn = document.createElement("button");
                        checkoutBtn.className = "checkout-button";
                        checkoutBtn.textContent = "Checka ut";
                        checkoutBtn.addEventListener("click", function () {
                            alert("Checkout-funktionalitet kommer här!");
                        });

                        const continueBtn = document.createElement("button");
                        continueBtn.className = "continue-shopping-button";
                        continueBtn.textContent = "Fortsätt handla";
                        continueBtn.addEventListener("click", function () {
                            app.closeCartModal();
                        });

                        summary.appendChild(line1);
                        summary.appendChild(line2);
                        summary.appendChild(line3);
                        summary.appendChild(checkoutBtn);
                        summary.appendChild(continueBtn);

                        layout.appendChild(itemsDiv);
                        layout.appendChild(summary);

                        container.appendChild(layout);
                    },

                    /*
                     * addToCart(productId)
                     * Advanced constructs replaced: find() and object spread {...product, quantity:1}
                     * Beginner-friendly: find with for-loop and build a new object explicitly
                     */
                    addToCart: function (productId) {
                        let product = null;
                        for (let i = 0; i < products.length; i++) {
                            if (products[i].id === productId) {
                                product = products[i];
                                break;
                            }
                        }

                        let existingItem = null;
                        for (let k = 0; k < this.cart.length; k++) {
                            if (this.cart[k].id === productId) {
                                existingItem = this.cart[k];
                                break;
                            }
                        }

                        if (existingItem) {
                            existingItem.quantity++;
                        } else {
                            // Explicitly create a new item object (no spread operator)
                            const newItem = {
                                id: product.id,
                                name: product.name,
                                price: product.price,
                                image: product.image,
                                quantity: 1,
                            };
                            this.cart.push(newItem);
                        }

                        this.updateCartBadge();
                        // Re-render products so action buttons update
                        this.renderProducts();
                        // If cart modal is open, refresh it
                        const cm = document.getElementById("cart-modal");
                        if (cm && !cm.classList.contains("hidden")) {
                            this.showCartModal();
                        }
                        alert("Tillagd i varukorg!");
                    },

                    /*
                     * updateQuantity(productId, quantity)
                     * Advanced construct replaced: find() with a for-loop
                     */
                    updateQuantity: function (productId, quantity) {
                        if (quantity === 0) {
                            this.removeFromCart(productId);
                        } else {
                            for (let i = 0; i < this.cart.length; i++) {
                                if (this.cart[i].id === productId) {
                                    this.cart[i].quantity = quantity;
                                    break;
                                }
                            }
                            this.updateCartBadge();
                            this.renderCart();
                            // refresh modal if open
                            const cm = document.getElementById("cart-modal");
                            if (cm && !cm.classList.contains("hidden")) {
                                this.showCartModal();
                            }
                        }
                    },

                    /*
                     * removeFromCart(productId)
                     * Advanced construct replaced: filter() with a for-loop building a new array
                     */
                    removeFromCart: function (productId) {
                        const newCart = [];
                        for (let i = 0; i < this.cart.length; i++) {
                            if (this.cart[i].id !== productId) {
                                newCart.push(this.cart[i]);
                            }
                        }
                        this.cart = newCart;
                        this.updateCartBadge();
                        this.renderCart();
                        // refresh modal if open
                        const cm = document.getElementById("cart-modal");
                        if (cm && !cm.classList.contains("hidden")) {
                            this.showCartModal();
                        }
                        // Re-render products so action buttons update
                        this.renderProducts();
                    },

                    /*
                     * updateCartBadge()
                     * Advanced construct replaced: reduce() with a for-loop
                     */
                    updateCartBadge: function () {
                        let count = 0;
                        for (let i = 0; i < this.cart.length; i++) {
                            count += this.cart[i].quantity;
                        }
                        // Update both desktop and mobile badges
                        const desktopBadge =
                            document.getElementById("cart-badge");
                        const mobileBadge =
                            document.getElementById("cart-badge-mobile");
                        if (desktopBadge) {
                            desktopBadge.textContent = count;
                        }
                        if (mobileBadge) {
                            mobileBadge.textContent = count;
                        }
                        // If cart modal is open, refresh its content
                        const cm = document.getElementById("cart-modal");
                        if (cm && !cm.classList.contains("hidden")) {
                            this.showCartModal();
                        }
                    },

                    /*
                     * renderCart()
                     * Advanced construct replaced: building huge innerHTML with map/filter and template literals
                     * Beginner-friendly: construct the cart DOM using createElement and simple loops
                     */
                    renderCart: function () {
                        const container =
                            document.getElementById("cart-content");

                        if (this.cart.length === 0) {
                            // Build empty cart DOM without inline onclick
                            container.innerHTML = "";
                            const empty = document.createElement("div");
                            empty.className = "empty-cart";
                            const p = document.createElement("p");
                            p.textContent = "Din varukorg är tom";
                            const cont = document.createElement("button");
                            cont.className = "add-to-cart-button";
                            cont.textContent = "Fortsätt handla";
                            cont.addEventListener("click", function () {
                                app.navigateTo("home");
                            });
                            empty.appendChild(p);
                            empty.appendChild(cont);
                            container.appendChild(empty);
                            return;
                        }

                        let subtotal = 0;
                        for (let i = 0; i < this.cart.length; i++) {
                            subtotal +=
                                this.cart[i].price * this.cart[i].quantity;
                        }
                        const shipping = 150;
                        const total = subtotal + shipping;

                        container.innerHTML = "";

                        const layout = document.createElement("div");
                        layout.className = "cart-layout";

                        const itemsDiv = document.createElement("div");
                        itemsDiv.className = "cart-items";

                        for (let j = 0; j < this.cart.length; j++) {
                            const item = this.cart[j];

                            const cartItem = document.createElement("div");
                            cartItem.className = "cart-item";

                            const imageWrap = document.createElement("div");
                            imageWrap.className = "cart-item-image";
                            const iImg = document.createElement("img");
                            iImg.src = item.image;
                            iImg.alt = item.name;
                            imageWrap.appendChild(iImg);

                            const info = document.createElement("div");
                            info.className = "cart-item-info";
                            const nameDiv = document.createElement("div");
                            nameDiv.className = "cart-item-name";
                            nameDiv.textContent = item.name;
                            const priceDiv = document.createElement("div");
                            priceDiv.className = "cart-item-price";
                            priceDiv.textContent = item.price + " kr";

                            const qtyControls = document.createElement("div");
                            qtyControls.className = "quantity-controls";

                            const minusBtn = document.createElement("button");
                            minusBtn.className = "quantity-button";
                            minusBtn.innerHTML =
                                '<img src="icons/minus.svg" style="width:16px;height:16px;" alt="minus">';
                            (function (id, current) {
                                minusBtn.addEventListener("click", function () {
                                    app.updateQuantity(id, current - 1);
                                });
                            })(item.id, item.quantity);

                            const qtyDisplay = document.createElement("div");
                            qtyDisplay.className = "quantity-display";
                            qtyDisplay.textContent = item.quantity;

                            const plusBtn = document.createElement("button");
                            plusBtn.className = "quantity-button";
                            plusBtn.innerHTML =
                                '<img src="icons/plus.svg" style="width:16px;height:16px;" alt="plus">';
                            (function (id, current) {
                                plusBtn.addEventListener("click", function () {
                                    app.updateQuantity(id, current + 1);
                                });
                            })(item.id, item.quantity);

                            qtyControls.appendChild(minusBtn);
                            qtyControls.appendChild(qtyDisplay);
                            qtyControls.appendChild(plusBtn);

                            info.appendChild(nameDiv);
                            info.appendChild(priceDiv);
                            info.appendChild(qtyControls);

                            const actions = document.createElement("div");
                            actions.className = "cart-item-actions";

                            const removeBtn = document.createElement("button");
                            removeBtn.className = "remove-button";
                            removeBtn.innerHTML =
                                '<img src="icons/trash.svg" style="width:16px;height:16px;" alt="remove">';
                            (function (id) {
                                removeBtn.addEventListener(
                                    "click",
                                    function () {
                                        app.removeFromCart(id);
                                    }
                                );
                            })(item.id);

                            const itemTotal = document.createElement("div");
                            itemTotal.className = "cart-item-total";
                            itemTotal.textContent =
                                item.price * item.quantity + " kr";

                            actions.appendChild(removeBtn);
                            actions.appendChild(itemTotal);

                            cartItem.appendChild(imageWrap);
                            cartItem.appendChild(info);
                            cartItem.appendChild(actions);

                            itemsDiv.appendChild(cartItem);
                        }

                        const summary = document.createElement("div");
                        summary.className = "order-summary";
                        const h2 = document.createElement("h2");
                        h2.textContent = "Ordersammanfattning";
                        summary.appendChild(h2);

                        const line1 = document.createElement("div");
                        line1.className = "summary-line";
                        const s1a = document.createElement("span");
                        s1a.textContent = "Delsumma";
                        const s1b = document.createElement("span");
                        s1b.textContent = subtotal + " kr";
                        line1.appendChild(s1a);
                        line1.appendChild(s1b);

                        const line2 = document.createElement("div");
                        line2.className = "summary-line";
                        const s2a = document.createElement("span");
                        s2a.textContent = "Frakt";
                        const s2b = document.createElement("span");
                        s2b.textContent = shipping + " kr";
                        line2.appendChild(s2a);
                        line2.appendChild(s2b);

                        const line3 = document.createElement("div");
                        line3.className = "summary-line total";
                        const s3a = document.createElement("span");
                        s3a.textContent = "Total";
                        const s3b = document.createElement("span");
                        s3b.textContent = total + " kr";
                        line3.appendChild(s3a);
                        line3.appendChild(s3b);

                        const checkoutBtn = document.createElement("button");
                        checkoutBtn.className = "checkout-button";
                        checkoutBtn.textContent = "Checka ut";
                        checkoutBtn.addEventListener("click", function () {
                            alert("Checkout-funktionalitet kommer här!");
                        });

                        const continueBtn = document.createElement("button");
                        continueBtn.className = "continue-shopping-button";
                        continueBtn.textContent = "Fortsätt handla";
                        continueBtn.addEventListener("click", function () {
                            app.navigateTo("home");
                        });

                        summary.appendChild(line1);
                        summary.appendChild(line2);
                        summary.appendChild(line3);
                        summary.appendChild(checkoutBtn);
                        summary.appendChild(continueBtn);

                        layout.appendChild(itemsDiv);
                        layout.appendChild(summary);

                        container.appendChild(layout);
                    },
                };

                // Initialize app
                app.init();
            })();
        </script>
    </body>
</html>
